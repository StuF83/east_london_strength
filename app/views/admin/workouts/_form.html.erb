<section class="admin-workout-form">
  <div class="container">
    <header class="admin-header">
      <h1 class="admin-title"><%= page_title %></h1>
      <div class="admin-actions">
        <% header_links.each do |link| %>
          <%= link_to link[:text], link[:path], class: link[:class] %>
        <% end %>
      </div>
    </header>
    
    <div data-controller="workout-preview" 
         data-action="lexxy:change->workout-preview#refresh input->workout-preview#refreshDebounced change->workout-preview#refresh">
      <%= form_with model: [:admin, workout], class: "workout-form" do |form| %>
        <% if workout.errors.any? %>
          <div class="form-errors">
            <h4><%= pluralize(workout.errors.count, "error") %> prohibited this workout from being saved:</h4>
            <ul>
              <% workout.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <div class="form-group">
          <%= form.label :date, class: "form-label" %>
          <%= form.date_field :date, class: "form-input" %>
        </div>

        <div class="form-group">
          <%= form.label :title, "Title (optional)", class: "form-label" %>
          <%= form.text_field :title, class: "form-input", placeholder: "e.g., Upper Body Strength" %>
        </div>

        <div class="form-group">
          <%= form.label :content, "Workout Content", class: "form-label" %>
          <div data-workout-preview-target="editor">
            <%= form.rich_text_area :content, placeholder: "Write your workout..." do %>
            <% end %>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Preview</label>
          <div data-workout-preview-target="preview">
            <!-- Render shared workout partial for initial preview -->
            <%= render "/shared/workout_content", workout: workout %>
          </div>
        </div>

        <div class="form-group">
          <%= form.label :tags, "Tags (optional)", class: "form-label" %>
          <%= form.text_field :tags, 
              class: "form-input", 
              placeholder: "upper body, strength, pushing, pulling" %>
          <small class="form-help">Comma-separated tags for organization</small>
        </div>

        <div class="form-group form-group--checkbox">
          <%= form.check_box :is_fallback, class: "form-checkbox" %>
          <%= form.label :is_fallback, "Fallback workout", class: "form-label form-label--checkbox" %>
          <small class="form-help">Use this as a backup workout when needed</small>
        </div>

        <div class="form-actions">
          <%= form.submit submit_text, class: "btn" %>
          <%= link_to "Cancel", cancel_path, class: "btn btn--secondary" %>
        </div>
      <% end %>
    </div>
  </div>
</section>