<section class="admin-workout-show">
  <div class="container">
    <header class="admin-header">
      <div>
        <h1 class="admin-title">
          <%= @workout.date.strftime("%A, %B %d, %Y") %>
          <% if @workout.is_fallback? %>
            <span class="workout-badge workout-badge--fallback">Fallback</span>
          <% end %>
        </h1>
        <% if @workout.title.present? %>
          <p class="workout-subtitle"><%= @workout.title %></p>
        <% end %>
      </div>
      
      <div class="admin-actions">
        <%= link_to "Edit", edit_admin_workout_path(@workout), class: "btn" %>
        <%= link_to "Back to List", admin_workouts_path, class: "btn btn--secondary" %>
      </div>
    </header>
    <div class="admin-workout-content">
      <div class="admin-workout-content__main">
        <%= render "shared/workout_content", workout: @workout %>
      </div>
      <aside class="admin-workout-content__sidebar">
        <div class="workout-meta">
          <h3>Details</h3>
          
          <div class="meta-item">
            <strong>Date:</strong>
            <%= @workout.date.strftime("%B %d, %Y") %>
          </div>
          <% if @workout.tags.present? %>
            <div class="meta-item">
              <strong>Tags:</strong>
              <span class="workout-tags"><%= @workout.tags %></span>
            </div>
          <% end %>
          <div class="meta-item">
            <strong>Type:</strong>
            <%= @workout.is_fallback? ? "Fallback Workout" : "Regular Workout" %>
          </div>
          <div class="meta-item">
            <strong>Created:</strong>
            <%= @workout.created_at.strftime("%b %d, %Y at %l:%M %p") %>
          </div>
          <% if @workout.updated_at != @workout.created_at %>
            <div class="meta-item">
              <strong>Updated:</strong>
              <%= @workout.updated_at.strftime("%b %d, %Y at %l:%M %p") %>
            </div>
          <% end %>
        </div>
        <div class="workout-actions" 
             data-controller="workout-copy"
             data-workout-copy-id-value="<%= @workout.id %>"
             data-workout-copy-existing-dates-url-value="<%= existing_dates_admin_workouts_path %>">
          <%= link_to "Edit Workout", edit_admin_workout_path(@workout), class: "btn btn--secondary" %>
          <button type="button" 
                  class="btn"
                  data-action="click->workout-copy#showDatePicker">
            Copy Workout
          </button>
          
          <!-- Hidden copy form that will be revealed when date is selected -->
          <div class="copy-confirmation" 
               data-workout-copy-target="confirmation"
               style="display: none;">
            <%= form_with url: admin_workouts_path, method: :post, local: true, 
                         data: { "workout-copy-target" => "form" } do |form| %>
              <%= form.hidden_field :source_workout_id, value: @workout.id %>
              <%= form.hidden_field :date, data: { "workout-copy-target" => "dateField" } %>
              <div class="copy-confirmation__content">
                <p>Copy to: <span data-workout-copy-target="selectedDate"></span></p>
                <%= form.submit "Confirm Copy", class: "btn btn--primary btn--small" %>
                <button type="button" 
                        class="btn btn--secondary btn--small"
                        data-action="click->workout-copy#cancel">
                  Cancel
                </button>
              </div>
            <% end %>
          </div>
          
          <%= link_to "Delete Workout", admin_workout_path(@workout), 
              method: :delete,
              class: "btn btn--danger",
              data: { 
                "turbo-method": :delete,
                "turbo-confirm": "Are you sure you want to delete this workout?" 
              } %>
        </div>
      </aside>
    </div>
  </div>
</section>